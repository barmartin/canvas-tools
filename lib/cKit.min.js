/*! cKit.min.js v0.1.8 November 01, 2014 */

var constants=function(){var t=Math.PI;return{SCENE_NORMAL:0,SCENE_GIF:1,PI:t,TWOPIDIV360:2*Math.PI/360,MAX_OBJECTS:4,DEFAULT_RAYS:6,DEFAULT_INNER_RADIUS_SCALAR:17,DEFAULT_OUTER_RADIUS_SCALAR:2.2}}({}),Vector=function(){"use strict";return{create:function(t,i){return{x:t||-1,y:i||-1}},multiply:function(t,i){return t.x*=i,t.y*=i,t},add:function(t,i){return t.x+=i.x,t.y+=i.y,t},getPoint:function(t,i,e,s){var o=t+e*Math.sin(s),n=i-e*Math.cos(s),h=this.create(o,n);return h},rotate:function(t,i,e,s){var o=Math.cos(s),n=Math.sin(s),h=o*(e.x-t)-n*(e.y-i)+t,r=n*(e.x-t)+o*(e.y-i)+i;return this.create(h,r)},distance:function(t,i){var e=t.x-i.x,s=t.y-i.y;return Math.sqrt(e*e+s*s)}}}({}),CPoint=function(t,i){"use strict";var i=i,e=function(t,e,s,o,n){this.kit=t,this.x=e,this.y=s,this.index=n,this.inDrag=!1,this.draw=function(){if(this.kit.inCurveEditMode){var e=this.kit.Vector.rotate(t.midWidth,t.midHeight,this,o.rotation*i.TWOPIDIV360);if(this.inDrag)if(1===n){var s=this.kit.Vector.rotate(t.midWidth,t.midHeight,o.controlPoints[0],o.rotation*i.TWOPIDIV360);t.context.beginPath(),t.context.moveTo(e.x,e.y),t.context.lineTo(s.x,s.y),t.context.stroke()}else if(2===n){var h=this.kit.Vector.rotate(t.midWidth,t.midHeight,o.controlPoints[3],o.rotation*i.TWOPIDIV360);t.context.beginPath(),t.context.moveTo(e.x,e.y),t.context.lineTo(h.x,h.y),t.context.stroke()}t.context.beginPath(),t.context.arc(e.x,e.y,this.kit.controlPointRadius,0,2*Math.PI,!0),t.context.closePath(),t.context.lineWidth=1,this.inDrag?(t.context.fillStyle="#999999",t.context.fill()):(t.context.fillStyle="#FFFFFF",t.context.fill()),t.context.stroke()}},this.mouseInside=function(t){return this.kit.controlPointRadius+2>this.kit.Vector.distance(t,this)}};return e}({},constants),util=function(){"use strict";return{getPosition:function(t,i){var e=i.getBoundingClientRect();return{x:t.clientX-e.left,y:t.clientY-e.top}},clone:function(t){if(null==t||"object"!=typeof t)return t;var i=t.constructor();for(var e in t)t.hasOwnProperty(e)&&(i[e]=t[e]);return i},dnexist:function(t){return"undefined"==typeof t},exists:function(t){return"undefined"!=typeof t},encodeToHex:function(t){return parseInt(255*t).toString(16)},decodeFromHex:function(t){return parseInt(t,16)},validateInt:function(t){return parseInt(t)},toRGB:function(t){return[this.decodeFromHex(t.substring(0,2)),this.decodeFromHex(t.substring(2,4)),this.decodeFromHex(t.substring(4,6))]},msTime:function(){return(new Date).getTime()},each:function(t,i){if(null==t)return t;var e,s=t.length;if(s===+s)for(e=0;s>e;e++)i(t[e],e,t);return t},range:function(t,i){for(var e=[],s=t;i>s;s++)e.push(s);return e},indexOf:function(t,i){for(var e=0;e<t.length;e++)if(t[e]===i)return e;return console.log("Item not Found, IndexOf (should not happen with current config)"),-1},debugConsole:function(t){var i=document.getElementById("console");i.firstChild&&i.removeChild(i.firstChild),i.appendChild(document.createTextNode(t))}}}({}),PedalFlower=function(t,i,e,s,o){"use strict";var i=i,e=e,s=s,n=o,h=function(t,i,o,n){this.kit=t,this.rotation=0,this.pedalCount=i,this.increment=2*Math.PI/i,this.firstInnerAngle=-.5*this.increment,this.innerRadius=o,this.outerRadius=n,this.allPedals=[],this.firstPedal=[],this.controlPoints=[],this.thisAngle=0;var h,r,a,c;if(8===this.kit.curve.length)h=s.create(t.curve[0],this.kit.curve[1]),r=s.create(t.curve[2],this.kit.curve[3]),a=s.create(t.curve[4],this.kit.curve[5]),c=s.create(t.curve[6],this.kit.curve[7]);else{h=s.getPoint(this.kit.midWidth,this.kit.midHeight,this.innerRadius,this.firstInnerAngle);var d=(this.outerRadius-this.innerRadius)/2+this.innerRadius;r=s.getPoint(this.kit.midWidth,this.kit.midHeight,d,this.firstInnerAngle),a=s.getPoint(this.kit.midWidth,this.kit.midHeight,this.outerRadius,this.thisAngle),a.x=a.x-40,c=s.getPoint(this.kit.midWidth,this.kit.midHeight,this.outerRadius,this.thisAngle)}this.firstPedal.push(h),this.controlPoints.push(new e(t,h.x,h.y,this,0)),this.controlPoints.push(new e(t,r.x,r.y,this,1)),this.firstPedal.push(r),this.controlPoints.push(new e(t,a.x,a.y,this,2)),this.firstPedal.push(a),this.controlPoints.push(new e(t,c.x,c.y,this,3)),this.firstPedal.push(c),this.firstPedal.push(s.create(-1*(a.x-this.kit.midWidth)+this.kit.midWidth,a.y)),this.firstPedal.push(s.create(-1*(r.x-this.kit.midWidth)+this.kit.midWidth,r.y)),this.firstPedal.push(s.create(-1*(h.x-this.kit.midWidth)+this.kit.midWidth,h.y)),this.createPedals()};return h.prototype.createPedals=function(){this.allPedals.push(this.firstPedal);for(var t=this.kit,i=1;i<this.pedalCount;i++){this.thisAngle=i*this.increment;var e=[],o=this.thisAngle;n.each(this.firstPedal,function(i){var n=s.rotate(t.midWidth,t.midHeight,i,o);e.push(n)}),this.allPedals.push(e)}},h.prototype.updatePedal=function(t,i){var e=s.create(i.x,i.y);e.x<10&&(e.x=10),e.x>this.kit.canvasWidth-10&&(e.x=this.kit.canvasWidth-10),e.y<10&&(e.y=10),e.y>this.kit.canvasWidth-10&&(e.y=this.kit.canvasHeight-10),3===t?(e.x=this.kit.canvasWidth/2,this.firstPedal[3].x=e.x,this.firstPedal[t].y=i.y):0===t?(this.innerRadius=s.distance(s.create(this.kit.midWidth,this.kit.midHeight),s.create(i.x,i.y)),e=s.getPoint(this.kit.midWidth,this.kit.midHeight,this.innerRadius,this.firstInnerAngle),this.firstPedal[0].x=e.x,this.firstPedal[0].y=e.y,this.firstPedal[6].x=2*this.kit.canvasWidth/2-e.x,this.firstPedal[6].y=e.y):(this.firstPedal[t].x=i.x,this.firstPedal[6-t].x=2*this.kit.canvasWidth/2-i.x,this.firstPedal[6-t].y=i.y,this.firstPedal[t].y=i.y),this.allPedals=[],this.createPedals(),this.controlPoints[t].x=e.x,this.controlPoints[t].y=e.y},h.prototype.updateFirstPedal=function(){this.firstPedal[0].x=this.controlPoints[0].x,this.firstPedal[0].y=this.controlPoints[0].y,this.firstPedal[1].x=this.controlPoints[1].x,this.firstPedal[1].y=this.controlPoints[1].y,this.firstPedal[2].x=this.controlPoints[2].x,this.firstPedal[2].y=this.controlPoints[2].y,this.firstPedal[3].x=this.controlPoints[3].x,this.firstPedal[3].y=this.controlPoints[3].y,this.firstPedal[4].x=-1*(this.controlPoints[2].x-this.kit.midWidth)+this.kit.midWidth,this.firstPedal[4].y=this.controlPoints[2].y,this.firstPedal[5].x=-1*(this.controlPoints[1].x-this.kit.midWidth)+this.kit.midWidth,this.firstPedal[5].y=this.controlPoints[1].y,this.firstPedal[6].x=-1*(this.controlPoints[0].x-this.kit.midWidth)+this.kit.midWidth,this.firstPedal[6].y=this.controlPoints[0].y},h.prototype.setControlPoint=function(t,i){this.controlPoints[this.kit.indexOf(this.controlPoints,t)]=i},h.prototype.draw=function(){var t=0,e=this,o=this.kit;o.context.save(),o.context.beginPath(),n.each(this.allPedals,function(n){if(o.context.lineWidth=1,0===e.rotation)o.context.moveTo(n[0].x,n[0].y),o.context.bezierCurveTo(n[1].x,n[1].y,n[2].x,n[2].y,n[3].x,n[3].y),o.context.bezierCurveTo(n[4].x,n[4].y,n[5].x,n[5].y,n[6].x,n[6].y),o.context.moveTo(n[6].x,n[6].y),o.context.lineTo(n[0].x,n[0].y);else{for(var h=[],r=0;r<n.length;r++)h.push(s.rotate(o.midWidth,o.midHeight,n[r],e.rotation*i.TWOPIDIV360));o.context.moveTo(h[0].x,h[0].y),o.context.bezierCurveTo(h[1].x,h[1].y,h[2].x,h[2].y,h[3].x,h[3].y),o.context.bezierCurveTo(h[4].x,h[4].y,h[5].x,h[5].y,h[6].x,h[6].y),o.context.moveTo(h[6].x,h[6].y),o.context.lineTo(h[0].x,h[0].y)}t++}),o.context.closePath(),o.fillImageExists?(o.context.clip(),o.context.drawImage(o.fillImage,0,0,o.canvasWidth,o.canvasHeight),o.toggleCurveColor===!0&&(o.context.lineWidth=3,o.context.stroke())):o.context.stroke(),o.context.restore()},h.prototype.drawControlPoints=function(){var t=this.controlPoints;n.each(t,function(i){i.draw(t)})},h.prototype.getState=function(){var t=[];return n.each(this.controlPoints,function(i){t.push(s.create(i.x,i.y))}),{controlPoints:t,rotation:this.rotation}},h.prototype.setState=function(t){var i=this.kit;this.rotation=t.rotation,i.index=0,n.each(this.controlPoints,function(e){e.x=t.controlPoints[i.index].x,e.y=t.controlPoints[i.index].y,i.index++}),this.allPedals=[],this.updateFirstPedal(),this.createPedals(),i.redraw()},h}({},constants,CPoint,Vector,util),core=function(t,i,e,s,o,n){"use strict";var i=i,e=e,s=s,o=o,h=n,r=function(){this.constants=i,this._u=h,this.canvas=document.getElementById("myCanvas"),this.context="",this.canvasMode="static",this.keyFrames=[],this.updateMode=!1,this.animationMode=!1,this.segmentStartTime=0,this.segment=0,this.loopStartTime=0,this.setTime=0,this.pauseTime=200,this.frameDelay=60,this.gifFramerate=200,this.delta=-this.frameDelay,this.Vector=e,this.sceneMode=i.SCENE_NORMAL,this.encoder="",this.delayTime=0,this.initList=["flower"],this.curve=[],this.pattern=null,this.bodybg="020202",this.backgroundColor="010201",this.lineColor="9fb4f4",this.backgroundAlpha=1,document.getElementById("bgAlpha").value=this.backgroundAlpha,this.selectedObject=0,this.controlPointRadius=6,this.canvasWidth=640,this.canvasHeight=640,this.midWidth=this.canvasWidth/2,this.midHeight=this.canvasHeight/2,this.inCurveEditMode=!0,this.toggleCurveColor=!1,this.fieldFocus=!1,this.settingShelf={toggleCurveColor:this.toggleCurveColor,inCurveEditMode:this.inCurveEditMode},this.objList=[],this.objTypes=[],this.debugMode=!0,this.resourceList={},this.backgroundImageExists=!1,this.fillImageExists=!1,this.initializeCanvas=function(){this.initConstants(),this.bindEvents(),this.context=this.canvas.getContext("2d");var t=document.getElementById("k");if(t.value=i.DEFAULT_RAYS,0===this.objList.length?this.build():this.setState(),this.initFrame(),this.debugMode===!0){var e=window.getSampleJSON();this.loadData(e,!1)}this.redraw()},this.initConstants=function(){if(h.exists(this.positions)){if(24!==this.positions.length)return;this.curve.push(this.validateInt(this.positions.substring(0,3))),this.curve.push(this.validateInt(this.positions.substring(3,6))),this.curve.push(this.validateInt(this.positions.substring(6,9))),this.curve.push(this.validateInt(this.positions.substring(9,12))),this.curve.push(this.validateInt(this.positions.substring(12,15))),this.curve.push(this.validateInt(this.positions.substring(15,18))),this.curve.push(this.validateInt(this.positions.substring(18,21))),this.curve.push(this.validateInt(this.positions.substring(21,24)))}},this.build=function(){var t=this;h.each(h.range(0,this.initList.length),function(e){"polar"===t.initList[e]||"flower"===t.initList[e]&&(t.objList.push(new o(t,i.DEFAULT_RAYS,t.canvasHeight/i.DEFAULT_INNER_RADIUS_SCALAR,t.canvasHeight/i.DEFAULT_OUTER_RADIUS_SCALAR)),t.objTypes.push(["flower",i.DEFAULT_RAYS]))})},this.redraw=function(){if(this.context.save(),this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.context.restore(),this.context.strokeStyle="#"+this.lineColor,this.backgroundImageExists)this.context.drawImage(this.backgroundImage,0,0,this.canvasWidth,this.canvasHeight);else{var t=h.toRGB(this.backgroundColor);this.context.fillStyle="rgba("+t[0]+", "+t[1]+", "+t[2]+", "+this.backgroundAlpha+")",this.context.fillRect(0,0,this.canvasWidth,this.canvasHeight)}var i=this;h.each(this.objList,function(t){t.draw()}),h.each(this.objList,function(t){h.indexOf(i.objList,t)===i.selectedObject&&t.drawControlPoints()})},this.update=function(){var t=document.getElementById("k").value;isNaN(t)||this.objList[this.selectedObject]instanceof o&&(this.objList[this.selectedObject]=new o(this,t,this.canvasHeight/i.DEFAULT_INNER_RADIUS_SCALAR,this.canvasHeight/i.DEFAULT_OUTER_RADIUS_SCALAR),this.objTypes[this.selectedObject][1]=t,this.setState(),this.redraw())},this.initFrame=function(){if(this.keyFrames[this.segment]={},this.keyFrames[this.segment].obj=[],this.segment>0)for(var t=0;t<this.objList;t++)this.keyFrames[this.segment].obj[t].rotation=this.keyFrames[this.segment-1].obj[t].rotation,this.keyFrames[this.segment].obj[t].timing=this.keyFrames[this.segment-1].obj[t].timing;else for(var i=0;i<this.objList;i++)this.keyFrames[this.segment].obj[i].rotation=0,this.keyFrames[this.segment].obj[i].timing=1;this.setFrame()},this.setState=function(){for(var t=0;t<this.objList.length;t++)this.objList[t].setState(this.keyFrames[this.segment].obj[t])},this.getState=function(){for(var t=0;t<this.objList.length;t++)this.keyFrames[this.segment].obj[t]=this.objList[t].getState();this.keyFrames[this.segment].timing=parseFloat(document.getElementById("length").value)},this.clearScene=function(){this.objList=[],this.objTypes=[],this.resourceList={},this.backgroundImageExists=!1,this.fillImageExists=!1,this.keyFrames=[],this.segment=0,this.objList.push(new o(this,i.DEFAULT_RAYS,this.canvasHeight/i.DEFAULT_INNER_RADIUS_SCALAR,this.canvasHeight/i.DEFAULT_OUTER_RADIUS_SCALAR)),this.objTypes.push(["flower",i.DEFAULT_RAYS]),this.initFrame(),this.redraw(),window.updateInterface()},this.initializeCanvas()};r.prototype.addObject=function(){if(!(this.objList.length>=i.MAX_OBJECTS)){this.objList.push(new o(this,i.DEFAULT_RAYS,this.canvasHeight/i.DEFAULT_INNER_RADIUS_SCALAR,this.canvasHeight/i.DEFAULT_OUTER_RADIUS_SCALAR)),this.objTypes.push(["flower",i.DEFAULT_RAYS]);for(var t=0;t<this.keyFrames.length;t++)this.keyFrames[t].obj[this.objList.length-1]=this.objList[this.objList.length-1].getState(),this.keyFrames[t].obj[this.objList.length-1].timing=document.getElementById("length").value;var e=this.objList.length-1;this.selectedObject=e,this.redraw()}},r.prototype.addFillImage=function(t,i,e){this.fillImage=new Image,this.fillImage.onload=function(){window.kit.fillImageExists=!0,window.kit.redraw()},this.fillImage.src=t,this.resourceList.fillImageSource=t,this.resourceList.fillImageLabel=i,this.resourceList.fillImagePage=e},r.prototype.addBackGroundImage=function(t,i,e){this.backgroundImage=new Image,this.backgroundImage.onload=function(){window.kit.backgroundImageExists=!0,window.kit.redraw()},this.backgroundImage.src=t,this.resourceList.backgroundImageSource=t,this.resourceList.backgroundImageLabel=i,this.resourceList.backgroundImagePage=e},r.prototype.startDrag=function(t){var i=window.kit;i.position=h.getPosition(t,i.canvas),h.debugConsole("startDrag x:"+i.position.x+" y:"+i.position.y);var e=i.Vector.rotate(i.midWidth,i.midHeight,i.position,-i.objList[i.selectedObject].rotation*i.constants.TWOPIDIV360);h.each(i.objList[i.selectedObject].controlPoints,function(t){return t.mouseInside(e)?(t.inDrag=!0,i.canvasMode="cpDrag",void i.redraw()):void 0})},r.prototype.endDrag=function(t){var i=window.kit;i.canvasMode="static",i.position=h.getPosition(t,i.canvas),h.debugConsole("endDrag x:"+i.position.x+" y:"+i.position.y),h.each(i.objList,function(t){h.each(t.controlPoints,function(t){t.inDrag===!0&&(t.inDrag=!1,i.redraw())})}),i.getState()},r.prototype.move=function(t){var i=window.kit;"cpDrag"===i.canvasMode&&(i.position=h.getPosition(t,i.canvas),h.each(i.objList,function(t){var e=0;h.each(t.controlPoints,function(o){if(o.inDrag){var n=i.Vector.rotate(i.midWidth,i.midHeight,i.position,-i.objList[0].rotation*i.constants.TWOPIDIV360),r=new s(i,n.x,n.y,t,e);return r.inDrag=!0,t.updatePedal(e,r),h.debugConsole("newPoint.x/y::"+n.x+"/"+n.y+" indexof::"+h.indexOf(t.controlPoints,o)+" object type:"+t.type+"</p>"),void i.redraw()}e++})}),h.debugConsole("mousemove x:"+i.position.x+" y:"+i.position.y))},r.prototype.bindEvents=function(){this.canvas.addEventListener("touchstart",this.startDrag,!1),this.canvas.addEventListener("touchend",this.endDrag,!1),this.canvas.addEventListener("touchmove",this.move,!1),this.canvas.addEventListener("mousedown",this.startDrag,!1),this.canvas.addEventListener("mouseup",this.endDrag,!1),this.canvas.addEventListener("mousemove",this.move,!1)},r.prototype.setFrame=function(){for(var t=0;t<this.objList.length;t++)this.keyFrames[this.segment].obj[t]=this.objList[t].getState();this.keyFrames[this.segment].timing=parseFloat(document.getElementById("length").value);var i=document.getElementById("rotation").value;this.keyFrames[this.segment].obj[this.selectedObject].rotation=parseFloat(i)},r.prototype.setupGif=function(){this.encoder.setRepeat(0),this.encoder.setDelay(this.frameDelay)},r.prototype.gifInit=function(){this.encoder.setRepeat(10),this.encoder.setDelay(this.frameDelay),this.encoder.setSize(this.canvasWidth,this.canvasHeight),this.encoder.start(),this.sceneMode=i.SCENE_GIF,this.loopInit(),this.redraw()},r.prototype.gifComplete=function(){this.encoder.finish();var t=this.encoder.stream().getData(),e="data:image/gif;base64,"+window.encode64(t);window.open(e,"_blank"),this.sceneMode=i.SCENE_NORMAL,this.stopScene()},r.prototype.loopInit=function(){this.animationMode=!0,this.segment=0,this.loopStartTime=h.msTime(),this.segmentStartTime=this.loopStartTime,this.settingShelf={inCurveEditMode:this.inCurveEditMode,toggleCurveColor:this.toggleCurveColor},this.inCurveEditMode=!1,this.toggleCurveColor=!1,window.updateInterface()},r.prototype.stopScene=function(){this.inCurveEditMode=this.settingShelf.inCurveEditMode,this.toggleCurveColor=this.settingShelf.toggleCurveColor,this.sceneReset()},r.prototype.sceneReset=function(){this.animationMode=!1,this.segment=0,this.setState(),this.redraw()},r.prototype.setState=function(){for(var t=0;t<this.objList.length;t++)this.objList[t].setState(this.keyFrames[this.segment].obj[t])},r.prototype.sceneLoop=function(){if(!this.animationMode||this.keyFrames.length<2)return this.stopScene(),void window.updateInterface();if(this.sceneMode===i.SCENE_GIF?this.delta+=this.gifFramerate:this.delta=h.msTime()-this.segmentStartTime,0===this.segment&&this.delta>=this.pauseTime)this.segment=1,this.delta=0,this.segmentStartTime=h.msTime();else if(0!==this.segment)if(this.delta>1e3*this.keyFrames[this.segment-1].timing)if(this.segment<this.keyFrames.length)this.setState(),this.segment++,this.sceneMode===this.GIF?this.delta=0:this.segmentStartTime=h.msTime();else{if(this.sceneMode===i.SCENE_GIF)return void this.gifComplete();this.segment=0,this.setState(),this.segmentStartTime=h.msTime()}else this.updateSegment(this.delta);this.sceneMode===i.SCENE_GIF?(this.encoder.addFrame(this.context),setTimeout(function(){window.kit.sceneLoop()},.01)):setTimeout(function(){window.kit.sceneLoop()},window.kit.frameDelay)},r.prototype.updateSegment=function(t){var i=this.segment;this.segment===this.keyFrames.length&&(i=0);var e=t/(1e3*this.keyFrames[i].timing),o=0,n=this;h.each(this.keyFrames[i].obj,function(t){var r=0,a=[];h.each(t.controlPoints,function(t){var i=n.keyFrames[n.segment-1].obj[o].controlPoints[r].x*(1-e)+t.x*e,h=n.keyFrames[n.segment-1].obj[o].controlPoints[r].y*(1-e)+t.y*e,c=new s(n,i,h,n.objList[o],r);a.push(c),r++});var c={controlPoints:a},d=n.keyFrames[n.segment-1].obj[o].rotation,l=n.keyFrames[i].obj[o].rotation,u=l-d;Math.abs(u)>180&&(0>u?l+=360:d+=360),c.rotation=(d*(1-e)+l*e)%360,n.objList[o].setState(c),o++})},r.prototype.segmentLoop=function(){if(!this.animationMode||0===this.segment)return this.setState(),void window.updateInterface();var t=h.msTime()-this.loopStartTime-this.pauseTime;if(0>t)0!==this.setTime&&(this.segment--,this.setState(),this.segment++,this.setTime=0);else if(t>1e3*this.keyFrames[this.segment].timing)t>1e3*this.keyFrames[this.segment].timing+this.pauseTime?(this.loopStartTime=h.msTime(),this.segment--,this.setState(),this.segment++,this.setTime=0):this.setTime!==1e3*this.keyFrames[this.segment].timing&&(this.setState(),this.setTime=1e3*this.keyFrames[this.segment].timing);else{var i=t/(1e3*this.keyFrames[this.segment].timing),e=0,o=this;h.each(this.keyFrames[this.segment].obj,function(t){var n=0,r=[];h.each(t.controlPoints,function(t){var h=o.keyFrames[o.segment-1].obj[e].controlPoints[n].x*(1-i)+t.x*i,a=o.keyFrames[o.segment-1].obj[e].controlPoints[n].y*(1-i)+t.y*i,c=new s(o,h,a,o.objList[e],n);r.push(c),n++});var a={controlPoints:r},c=o.keyFrames[o.segment-1].obj[e].rotation,d=o.keyFrames[o.segment].obj[e].rotation,l=d-c;Math.abs(l)>180&&(0>l?d+=360:c+=360),a.rotation=(c*(1-i)+d*i)%360,o.objList[e].setState(a),e++})}setTimeout(function(){window.kit.segmentLoop()},window.kit.frameDelay)},r.prototype.loadData=function(t){this.objList=[],this.objTypes=[],this.resourceList=t[1],this.objTypes=t[2],this.keyFrames=t[3],this.objList=[];for(var e=0;e<this.objTypes.length;e++)"flower"===this.objTypes[e][0]?this.objList.push(new o(this,this.objTypes[e][1],this.canvasHeight/i.DEFAULT_INNER_RADIUS_SCALAR,this.canvasHeight/i.DEFAULT_OUTER_RADIUS_SCALAR)):"polar"===this.objTypes[e][0];this.selectedObject=0,this.options=t[0],this.currentSelector="bg-color",this.backgroundColor=this.options.backgroundColor,this.backgroundAlpha=this.options.backgroundAlpha,this.lineColor=this.options.lineColor,"string"==typeof this.resourceList.backgroundImageSource&&this.addBackGroundImage(this.resourceList.backgroundImageSource,this.resourceList.backgroundImageLabel,this.resourceList.backgroundImagePage),"string"==typeof this.resourceList.fillImageSource&&this.addFillImage(this.resourceList.fillImageSource,this.resourceList.fillImageLabel,this.resourceList.fillImagePage),this.preinit||window.setColor("#"+this.backgroundColor),this.currentSelector="line-color",this.preinit||window.setColor("#"+this.lineColor),this.segment=0,this.setState(),this.redraw()};for(var a in r.prototype)"function"==typeof r.prototype[a]&&(window[a]=r.prototype[a]);return r.prototype._preloadMethods=[],r.prototype._registeredMethods={pre:[],post:[],remove:[]},r.prototype.registerPreloadMethod=function(t){r.prototype._preloadMethods.push(t)}.bind(this),r.prototype.registerMethod=function(t,i){r.prototype._registeredMethods.hasOwnProperty(t)||(r.prototype._registeredMethods[t]=[]),r.prototype._registeredMethods[t].push(i)}.bind(this),r}({},constants,Vector,CPoint,PedalFlower,util),src_app=function(t,i){"use strict";var e=i,s=function(){window.kit=new e,window.initInterface()};return"complete"===document.readyState?s():window.addEventListener("load",s,!1),window.kit}({},core,constants,Vector,CPoint,PedalFlower);