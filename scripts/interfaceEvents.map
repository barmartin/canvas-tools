{"version":3,"file":"interfaceEvents.js","sources":["../../build/scripts/interfaceEvents.js"],"names":["initInterface","window","kit","initializeCanvas","initColorPickers","digest","x","dhtmlXColorPicker","y","z","init","setOnSelectHandler","setColor","setOnCancelHandler","$","hide","injectColor","backgroundColor","lineColor","bodybg","attr","click","this","currentSelector","show","color","substring","redraw","id","thisC","Array","_u","decodeFromHex","initKeyboard","document","addEventListener","keyDownHandler","event","fieldFocus","keyPressed","String","fromCharCode","keyCode","selectObject","selectPrev","selectNext","stopScene","loopInit","sceneLoop","removeClass","addClass","editMode","constants","EDIT_SHAPE","EDIT_TRANSFORM","EDIT_NONE","getSampleJSON","parseJSON","sampleJSON","dhx_globalImgPath","paletteWidth","paletteHeight"],"mappings":"AAEA,QAASA,iBACPC,OAAOC,IAAIC,mBACXC,mBACAF,IAAIG,SASN,QAASD,oBACP,GAAIF,GAAMD,OAAOC,IACbI,EAAI,GAAIC,mBAAkB,YAAY,GAAO,GAAO,GAAO,GAC3DC,EAAI,GAAID,mBAAkB,cAAc,GAAO,GAAO,GAAO,GAC7DE,EAAI,GAAIF,mBAAkB,UAAU,GAAO,GAAO,GAAO,EAC7DD,GAAEI,OAAOF,EAAEE,OAAOD,EAAEC,OACpBJ,EAAEK,mBAAmBC,UAAUJ,EAAEG,mBAAmBC,UAAUH,EAAEE,mBAAmBC,UACnFN,EAAEO,mBAAmB,WACnBC,EAAE,QAAQC,SAEZP,EAAEK,mBAAmB,WACnBC,EAAE,QAAQC,SAEZN,EAAEI,mBAAmB,WACnBC,EAAE,QAAQC,SAEZT,EAAES,OAAOP,EAAEO,OAAON,EAAEM,OACpBC,YAAY,WAAYd,EAAIe,iBAC5BD,YAAY,aAAcd,EAAIgB,WAC9BF,YAAY,eAAgBd,EAAIiB,QAChCL,EAAE,cAAcM,KAAK,QAAS,qBAAqBlB,EAAIiB,QAEvDL,EAAE,aAAaO,MAAM,WACnBZ,EAAEM,OACFN,EAAEG,SAASE,EAAEQ,MAAMF,KAAK,UACxBG,gBAAkBT,EAAEQ,MAAMF,KAAK,MAC/BN,EAAE,WAAWM,KAAK,QAAS,iBAC3BX,EAAEe,SAEJV,EAAE,iBAAiBO,MAAM,WACvBb,EAAEO,OACFP,EAAEI,SAASE,EAAEQ,MAAMF,KAAK,UACxBG,gBAAkBT,EAAEQ,MAAMF,KAAK,MAC/BN,EAAE,eAAeM,KAAK,QAAS,2BAC/BZ,EAAEgB,SAEJV,EAAE,eAAeO,MAAM,WACrBf,EAAES,OACFT,EAAEM,SAASE,EAAEQ,MAAMF,KAAK,UACxBG,gBAAkBT,EAAEQ,MAAMF,KAAK,MAC/BN,EAAE,aAAaM,KAAK,QAAS,iBAC7Bd,EAAEkB,SAIN,QAASZ,UAASa,GAChB,GAAIvB,GAAMD,OAAOC,GACM,cAApBqB,iBACDT,EAAES,iBAAiBH,KAAK,QAAS,oBAAsBK,EAAQ,KAC/DX,EAAES,gBAAgB,QAAQR,OAC1BC,YAAYO,gBAAiBE,EAAMC,UAAU,IAC7CZ,EAAES,gBAAgB,SAASC,OAC3BtB,EAAIe,gBAAkBQ,EAAMC,UAAU,GACtCxB,EAAIyB,UACwB,eAApBJ,iBACRT,EAAES,iBAAiBH,KAAK,QAAS,oBAAsBK,EAAQ,KAC/DX,EAAES,gBAAgB,QAAQR,OAC1BC,YAAYO,gBAAiBE,EAAMC,UAAU,IAC7CZ,EAAES,gBAAgB,SAASC,OAC3BtB,EAAIgB,UAAYO,EAAMC,UAAU,GAChCxB,EAAIyB,UACyB,iBAApBJ,kBACTT,EAAES,iBAAiBH,KAAK,QAAS,oBAAsBK,EAAQ,KAC/DX,EAAES,gBAAgB,QAAQR,OAC1BC,YAAYO,gBAAiBE,EAAMC,UAAU,IAC7CZ,EAAES,gBAAgB,SAASC,OAC3BV,EAAE,cAAcM,KAAK,QAAS,oBAAoBK,IAEpDX,EAAE,QAAQC,OAGZ,QAASC,aAAYY,EAAIH,GACvB,CAAA,GAAII,GAAQf,EAAE,IAAMc,EACP,IAAIE,OAAM5B,IAAI6B,GAAGC,cAAcP,EAAMC,UAAU,EAAG,IAAKxB,IAAI6B,GAAGC,cAAcP,EAAMC,UAAU,EAAG,IAAIxB,IAAI6B,GAAGC,cAAcP,EAAMC,UAAU,EAAG,KAIxJ,MAHAG,GAAMT,KAAK,QAAS,sBAAwBK,GAC5CI,EAAMT,KAAK,QAASK,IAEb,EAIT,QAASQ,gBACPC,SAASC,iBAAiB,UAAWC,gBAGvC,QAASA,gBAAeC,GACtB,GAAmB,GAAhBnC,IAAIoC,WACL,OAAO,CAET,IAAIC,GAAaC,OAAOC,aAAaJ,EAAMK,QA6C3C,OA1CkB,MAAfH,EACDrC,IAAIyC,aAAa,GACM,MAAfJ,EACRrC,IAAIyC,aAAa,GACM,MAAfJ,EACRrC,IAAIyC,aAAa,GACM,MAAfJ,EACRrC,IAAIyC,aAAa,GAIM,MAAfN,EAAMK,SAA2B,KAAZH,EAC7BrC,IAAI0C,aAEmB,MAAfP,EAAMK,SAA2B,KAAZH,EAC7BrC,IAAI2C,aAEkB,KAAdN,EACRrC,IAAI4C,YAEmB,KAAdP,GACTrC,IAAI6C,WACJ7C,IAAI8C,aAGkB,KAAdT,GACRzB,EAAE,qBAAqBmC,YAAY,UACnCnC,EAAE,eAAeoC,SAAS,UAC1BhD,IAAIiD,SAAWjD,IAAIkD,UAAUC,WAC7BnD,IAAIyB,UACkB,KAAdY,GACRzB,EAAE,qBAAqBmC,YAAY,UACnCnC,EAAE,mBAAmBoC,SAAS,UAC9BhD,IAAIiD,SAAWjD,IAAIkD,UAAUE,eAC7BpD,IAAIyB,UACkB,KAAdY,IACRzB,EAAE,qBAAqBmC,YAAY,UACnCnC,EAAE,cAAcoC,SAAS,UACzBhD,IAAIiD,SAAWjD,IAAIkD,UAAUG,UAC7BrD,IAAIyB,UAENzB,IAAIG,UACG,EAGT,QAASmD,iBACP,MAAO1C,GAAE2C,UAAUC,YA/IrB,GAAInC,gBACJtB,QAAO0D,kBAAkB,gBACzB,IAAIC,cAAe,GACfC,cAAgB,GA8IhBH,WAAa","sourcesContent":["// This is the final initialization that needs to happen after Angular loads\n// Digest triggers an update of the Angular UI\nfunction initInterface() {\n  window.kit.initializeCanvas();\n  initColorPickers();\n  kit.digest();\n}\n\n// COLOR PICKER\nvar currentSelector;\nwindow.dhx_globalImgPath='styles/img/cp/';\nvar paletteWidth = 45;\nvar paletteHeight = 45;\n\nfunction initColorPickers() {\n  var kit = window.kit;\n  var x = new dhtmlXColorPicker('cpc-line', false, false, false, false);\n  var y = new dhtmlXColorPicker('cpc-bodybg', false, false, false, false);\n  var z = new dhtmlXColorPicker('cpc-bg', false, false, false, false);\n  x.init();y.init();z.init();\n  x.setOnSelectHandler(setColor);y.setOnSelectHandler(setColor);z.setOnSelectHandler(setColor);\n  x.setOnCancelHandler(function () {\n    $('.cpc').hide();\n  });\n  y.setOnCancelHandler(function () {\n    $('.cpc').hide();\n  });\n  z.setOnCancelHandler(function () {\n    $('.cpc').hide();\n  });\n  x.hide();y.hide();z.hide();\n  injectColor('bg-color', kit.backgroundColor);\n  injectColor('line-color', kit.lineColor);\n  injectColor('bodybg-color', kit.bodybg);\n  $('body, html').attr('style', 'background-color:#'+kit.bodybg);\n\n  $('#bg-color').click(function() {\n    z.hide();\n    z.setColor($(this).attr('color'));\n    currentSelector = $(this).attr('id');\n    $('#cpc-bg').attr('style', 'width: 252px;');\n    z.show();\n  });\n  $('#bodybg-color').click(function() {\n    y.hide();\n    y.setColor($(this).attr('color'));\n    currentSelector = $(this).attr('id');\n    $('#cpc-bodybg').attr('style', 'width: 252px; top:' + 53 + 'px;');\n    y.show();\n  });\n  $('#line-color').click(function() {\n    x.hide();\n    x.setColor($(this).attr('color'));\n    currentSelector = $(this).attr('id');\n    $('#cpc-line').attr('style', 'width: 252px;');\n    x.show();\n  });\n}\n\nfunction setColor(color) {\n  var kit = window.kit;\n  if(currentSelector === 'bg-color') {\n    $(currentSelector).attr('style', 'background-color:' + color + ';');\n    $(currentSelector+' img').hide();\n    injectColor(currentSelector, color.substring(1));\n    $(currentSelector+'+ img').show();\n    kit.backgroundColor = color.substring(1);\n    kit.redraw();\n  } else if(currentSelector === 'line-color') {\n    $(currentSelector).attr('style', 'background-color:' + color + ';');\n    $(currentSelector+' img').hide();\n    injectColor(currentSelector, color.substring(1));\n    $(currentSelector+'+ img').show();\n    kit.lineColor = color.substring(1);\n    kit.redraw();\n  } else if( currentSelector === 'bodybg-color') {\n    $(currentSelector).attr('style', 'background-color:' + color + ';');\n    $(currentSelector+' img').hide();\n    injectColor(currentSelector, color.substring(1));\n    $(currentSelector+'+ img').show();\n    $('body, html').attr('style', 'background-color:'+color);\n  }\n  $('.cpc').hide();\n}\n\nfunction injectColor(id, color) {\n  var thisC = $('#' + id);\n  var theseC = new Array(kit._u.decodeFromHex(color.substring(0, 2)), kit._u.decodeFromHex(color.substring(2, 4)),kit._u.decodeFromHex(color.substring(4, 6)));\n  thisC.attr('style', 'background-color: #' + color);\n  thisC.attr('color', color);\n  //$('#' + id).html(gripImg(theseC[0],theseC[1] ,theseC[2]));\n  return false;\n}\n\n// KEYBOARD HANDLING\nfunction initKeyboard() {\n  document.addEventListener(\"keydown\", keyDownHandler);\n}\n\nfunction keyDownHandler(event) {\n  if(kit.fieldFocus==true) {\n    return false;\n  }\n  var keyPressed = String.fromCharCode(event.keyCode);\n\n  // OBJECT SELECTION\n  if(keyPressed === '1') {   \n    kit.selectObject(0);\n  } else if(keyPressed === '2') { \n    kit.selectObject(1);\n  } else if(keyPressed === '3') { \n    kit.selectObject(2);\n  } else if(keyPressed === '4') { \n    kit.selectObject(3);\n\n  // KEYFRAME SELECTION\n  // LEFT CURSOR (BACK)\n  } else if(event.keyCode=='37'||keyPressed=='%') { \n    kit.selectPrev();\n  // RIGHT CURSOR (FORWARD)\n  } else if(event.keyCode=='39'||keyPressed==\"'\") { \n    kit.selectNext();\n  // 65 A KEY (STOP)\n  } else if(keyPressed == 'A') { \n    kit.stopScene();\n  // 83 S KEY (START)\n  } else if (keyPressed == 'S') { \n    kit.loopInit();\n    kit.sceneLoop();\n\n  // EDIT MODES  \n  } else if(keyPressed == 'Q') { \n    $('.edit-mode button').removeClass('active');\n    $('#edit-shape').addClass('active');\n    kit.editMode = kit.constants.EDIT_SHAPE;\n    kit.redraw();\n  } else if(keyPressed == 'W') { \n    $('.edit-mode button').removeClass('active');\n    $('#edit-transform').addClass('active');\n    kit.editMode = kit.constants.EDIT_TRANSFORM;\n    kit.redraw();\n  } else if(keyPressed == 'E') { \n    $('.edit-mode button').removeClass('active');\n    $('#edit-none').addClass('active');\n    kit.editMode = kit.constants.EDIT_NONE;\n    kit.redraw();\n  }\n  kit.digest();\n  return false;\n}\n\nfunction getSampleJSON() {\n  return $.parseJSON(sampleJSON);\n}\nvar sampleJSON = '[{\"backgroundColor\":\"010201\",\"backgroundAlpha\":\"1\",\"lineColor\":\"9fb4f4\",\"sourceMode\":\"lighter\",\"seamlessAnimation\":true}, \\\n{\"fillImageSource\":\"styles/img/darkmountain.jpg\", \"fillImagePage\": \"http://gorettmisstag.tumblr.com/post/99916508796/by-anthony-hurd\"},[[\"flower\",6,2],[\"flower\",12,1]],[{\"obj\":[{\"shapePoints\":[{\"x\":-7.9017,\"y\":-4.5621},{\"x\":-14.5,\"y\":-48}, \\\n{\"x\":-12.5,\"y\":-113},{\"x\":0,\"y\":-212}],\"rotation\":0,\"scale\":1,\"position\":{\"x\":250,\"y\":250}},{\"shapePoints\":[{\"x\":-59.6218,\"y\":-222.5118},{\"x\":-238.5,\"y\":-215}, \\\n{\"x\":-35.5,\"y\":-234},{\"x\":0,\"y\":-207}],\"rotation\":0,\"scale\":1,\"position\":{\"x\":250,\"y\":250}}],\"timing\":1.5},{\"obj\":[{\"shapePoints\":[{\"x\":-46.7674,\"y\":-27.0011}, \\\n{\"x\":-10.6255,\"y\":46.4042},{\"x\":15.0538,\"y\":-38.0741},{\"x\":0,\"y\":-228.406}],\"rotation\":1.0472,\"scale\":1,\"position\":{\"x\":250,\"y\":250}},{\"shapePoints\":[{\"x\":-59.5707,\"y\":-222.3209}, \\\n{\"x\":94.9698,\"y\":-18.4928},{\"x\":-22.4701,\"y\":-107.081},{\"x\":0,\"y\":-220.3439}],\"rotation\":1.0472,\"scale\":1,\"position\":{\"x\":250,\"y\":250}}],\"timing\":1.5}, \\\n{\"obj\":[{\"shapePoints\":[{\"x\":-56.3665,\"y\":-32.5432},{\"x\":-12.7665,\"y\":29.8876},{\"x\":-65.4994,\"y\":248.55},{\"x\":0,\"y\":-116.9375}], \\\n\"rotation\":2.0944,\"scale\":1,\"position\":{\"x\":250,\"y\":250}},{\"shapePoints\":[{\"x\":-59.353272788517614,\"y\":-221.50942964224305},{\"x\":124.9179,\"y\":114.3625},{\"x\":-24.5572,\"y\":-166.5329}, \\\n{\"x\":0,\"y\":-73.0907}],\"rotation\":2.0944,\"scale\":1,\"position\":{\"x\":250,\"y\":250}}],\"timing\":1.5},{\"obj\":[{\"shapePoints\":[{\"x\":-36.1688,\"y\":-20.8821},{\"x\":41.4995,\"y\":199.0001}, \\\n{\"x\":-48.5001,\"y\":54.9999},{\"x\":0,\"y\":-181}],\"rotation\":3.14159,\"scale\":1,\"position\":{\"x\":250,\"y\":250}},{\"shapePoints\":[{\"x\":-32.8824,\"y\":-122.7191},{\"x\":-104.5003,\"y\":119.9997}, \\\n{\"x\":-158.5006,\"y\":217.9996},{\"x\":0,\"y\":-174}],\"rotation\":3.14159,\"scale\":1,\"position\":{\"x\":250,\"y\":250}}],\"timing\":1.5},{\"obj\":[{\"shapePoints\":[{\"x\":-36.3963,\"y\":-21.0134}, \\\n{\"x\":239.082,\"y\":-98.1021},{\"x\":-113.2282,\"y\":24.1169},{\"x\":0,\"y\":-189.5952}],\"rotation\":4.18879,\"scale\":1,\"position\":{\"x\":250,\"y\":250}},{\"shapePoints\":[{\"x\":-30.2389,\"y\":-112.8532}, \\\n{\"x\":102.0461,\"y\":147.251},{\"x\":-71.2641,\"y\":-40.567},{\"x\":0,\"y\":-182.765}],\"rotation\":4.18879,\"scale\":1,\"position\":{\"x\":250,\"y\":250}}],\"timing\":1.5},{\"obj\":[{\"shapePoints\":[ {\"x\":-1.299,\"y\":-0.75},\\\n{\"x\":-163.3706,\"y\":-122.034},{\"x\":166.2007,\"y\":127.1321},{\"x\":0,\"y\":161.6275}],\"rotation\":5.75959,\"scale\":0.684,\"position\":{\"x\":250,\"y\":250}}, {\"shapePoints\":[{\"x\":-1.5861,\"y\":-5.9194}, \\\n{\"x\":67.2928,\"y\":184.0119},{\"x\":21.4111,\"y\":-132.8091},{\"x\":0,\"y\":133.0052}],\"rotation\":5.23599,\"scale\":1.034240832,\"position\": {\"x\":250,\"y\":250}}],\"timing\":1.5}]]';\n"]}