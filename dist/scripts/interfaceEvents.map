{"version":3,"file":"interfaceEvents.js","sources":["../../build/scripts/interfaceEvents.js"],"names":["initInterface","window","kit","initializeCanvas","initColorPickers","digest","x","dhtmlXColorPicker","y","z","init","setOnSelectHandler","setColor","setOnCancelHandler","$","hide","injectColor","backgroundColor","lineColor","bodybg","attr","click","this","currentSelector","show","color","substring","redraw","id","thisC","Array","_u","decodeFromHex","initKeyboard","document","addEventListener","keyDownHandler","event","fieldFocus","keyPressed","String","fromCharCode","keyCode","selectObject","selectPrev","selectNext","stopScene","loopInit","sceneLoop","removeClass","addClass","editMode","constants","EDIT_SHAPE","EDIT_TRANSFORM","EDIT_NONE","getSampleJSON","parseJSON","sampleJSON","dhx_globalImgPath","paletteWidth","paletteHeight"],"mappings":"AAEA,QAASA,iBACPC,OAAOC,IAAIC,mBACXC,mBACAF,IAAIG,SASN,QAASD,oBACP,GAAIF,GAAMD,OAAOC,IACbI,EAAI,GAAIC,mBAAkB,YAAY,GAAO,GAAO,GAAO,GAC3DC,EAAI,GAAID,mBAAkB,cAAc,GAAO,GAAO,GAAO,GAC7DE,EAAI,GAAIF,mBAAkB,UAAU,GAAO,GAAO,GAAO,EAC7DD,GAAEI,OAAOF,EAAEE,OAAOD,EAAEC,OACpBJ,EAAEK,mBAAmBC,UAAUJ,EAAEG,mBAAmBC,UAAUH,EAAEE,mBAAmBC,UACnFN,EAAEO,mBAAmB,WACnBC,EAAE,QAAQC,SAEZP,EAAEK,mBAAmB,WACnBC,EAAE,QAAQC,SAEZN,EAAEI,mBAAmB,WACnBC,EAAE,QAAQC,SAEZT,EAAES,OAAOP,EAAEO,OAAON,EAAEM,OACpBC,YAAY,WAAYd,EAAIe,iBAC5BD,YAAY,aAAcd,EAAIgB,WAC9BF,YAAY,eAAgBd,EAAIiB,QAChCL,EAAE,cAAcM,KAAK,QAAS,qBAAqBlB,EAAIiB,QAEvDL,EAAE,aAAaO,MAAM,WACnBZ,EAAEM,OACFN,EAAEG,SAASE,EAAEQ,MAAMF,KAAK,UACxBG,gBAAkBT,EAAEQ,MAAMF,KAAK,MAC/BN,EAAE,WAAWM,KAAK,QAAS,iBAC3BX,EAAEe,SAEJV,EAAE,iBAAiBO,MAAM,WACvBb,EAAEO,OACFP,EAAEI,SAASE,EAAEQ,MAAMF,KAAK,UACxBG,gBAAkBT,EAAEQ,MAAMF,KAAK,MAC/BN,EAAE,eAAeM,KAAK,QAAS,2BAC/BZ,EAAEgB,SAEJV,EAAE,eAAeO,MAAM,WACrBf,EAAES,OACFT,EAAEM,SAASE,EAAEQ,MAAMF,KAAK,UACxBG,gBAAkBT,EAAEQ,MAAMF,KAAK,MAC/BN,EAAE,aAAaM,KAAK,QAAS,iBAC7Bd,EAAEkB,SAIN,QAASZ,UAASa,GAChB,GAAIvB,GAAMD,OAAOC,GACM,cAApBqB,iBACDT,EAAES,iBAAiBH,KAAK,QAAS,oBAAsBK,EAAQ,KAC/DX,EAAES,gBAAgB,QAAQR,OAC1BC,YAAYO,gBAAiBE,EAAMC,UAAU,IAC7CZ,EAAES,gBAAgB,SAASC,OAC3BtB,EAAIe,gBAAkBQ,EAAMC,UAAU,GACtCxB,EAAIyB,UACwB,eAApBJ,iBACRT,EAAES,iBAAiBH,KAAK,QAAS,oBAAsBK,EAAQ,KAC/DX,EAAES,gBAAgB,QAAQR,OAC1BC,YAAYO,gBAAiBE,EAAMC,UAAU,IAC7CZ,EAAES,gBAAgB,SAASC,OAC3BtB,EAAIgB,UAAYO,EAAMC,UAAU,GAChCxB,EAAIyB,UACyB,iBAApBJ,kBACTT,EAAES,iBAAiBH,KAAK,QAAS,oBAAsBK,EAAQ,KAC/DX,EAAES,gBAAgB,QAAQR,OAC1BC,YAAYO,gBAAiBE,EAAMC,UAAU,IAC7CZ,EAAES,gBAAgB,SAASC,OAC3BV,EAAE,cAAcM,KAAK,QAAS,oBAAoBK,IAEpDX,EAAE,QAAQC,OAGZ,QAASC,aAAYY,EAAIH,GACvB,CAAA,GAAII,GAAQf,EAAE,IAAMc,EACP,IAAIE,OAAM5B,IAAI6B,GAAGC,cAAcP,EAAMC,UAAU,EAAG,IAAKxB,IAAI6B,GAAGC,cAAcP,EAAMC,UAAU,EAAG,IAAIxB,IAAI6B,GAAGC,cAAcP,EAAMC,UAAU,EAAG,KAIxJ,MAHAG,GAAMT,KAAK,QAAS,sBAAwBK,GAC5CI,EAAMT,KAAK,QAASK,IAEb,EAIT,QAASQ,gBACPC,SAASC,iBAAiB,UAAWC,gBAGvC,QAASA,gBAAeC,GACtB,GAAmB,GAAhBnC,IAAIoC,WACL,OAAO,CAET,IAAIC,GAAaC,OAAOC,aAAaJ,EAAMK,QA6C3C,OA1CkB,MAAfH,EACDrC,IAAIyC,aAAa,GACM,MAAfJ,EACRrC,IAAIyC,aAAa,GACM,MAAfJ,EACRrC,IAAIyC,aAAa,GACM,MAAfJ,EACRrC,IAAIyC,aAAa,GAIM,MAAfN,EAAMK,SAA2B,KAAZH,EAC7BrC,IAAI0C,aAEmB,MAAfP,EAAMK,SAA2B,KAAZH,EAC7BrC,IAAI2C,aAEkB,KAAdN,EACRrC,IAAI4C,YAEmB,KAAdP,GACTrC,IAAI6C,WACJ7C,IAAI8C,aAGkB,KAAdT,GACRzB,EAAE,qBAAqBmC,YAAY,UACnCnC,EAAE,eAAeoC,SAAS,UAC1BhD,IAAIiD,SAAWjD,IAAIkD,UAAUC,WAC7BnD,IAAIyB,UACkB,KAAdY,GACRzB,EAAE,qBAAqBmC,YAAY,UACnCnC,EAAE,mBAAmBoC,SAAS,UAC9BhD,IAAIiD,SAAWjD,IAAIkD,UAAUE,eAC7BpD,IAAIyB,UACkB,KAAdY,IACRzB,EAAE,qBAAqBmC,YAAY,UACnCnC,EAAE,cAAcoC,SAAS,UACzBhD,IAAIiD,SAAWjD,IAAIkD,UAAUG,UAC7BrD,IAAIyB,UAENzB,IAAIG,UACG,EAGT,QAASmD,iBACP,MAAO1C,GAAE2C,UAAUC,YA/IrB,GAAInC,gBACJtB,QAAO0D,kBAAkB,gBACzB,IAAIC,cAAe,GACfC,cAAgB,GA8IhBH,WAAa","sourcesContent":["// This is the final initialization that needs to happen after Angular loads\n// Digest triggers an update of the Angular UI\nfunction initInterface() {\n  window.kit.initializeCanvas();\n  initColorPickers();\n  kit.digest();\n}\n\n// COLOR PICKER\nvar currentSelector;\nwindow.dhx_globalImgPath='styles/img/cp/';\nvar paletteWidth = 45;\nvar paletteHeight = 45;\n\nfunction initColorPickers() {\n  var kit = window.kit;\n  var x = new dhtmlXColorPicker('cpc-line', false, false, false, false);\n  var y = new dhtmlXColorPicker('cpc-bodybg', false, false, false, false);\n  var z = new dhtmlXColorPicker('cpc-bg', false, false, false, false);\n  x.init();y.init();z.init();\n  x.setOnSelectHandler(setColor);y.setOnSelectHandler(setColor);z.setOnSelectHandler(setColor);\n  x.setOnCancelHandler(function () {\n    $('.cpc').hide();\n  });\n  y.setOnCancelHandler(function () {\n    $('.cpc').hide();\n  });\n  z.setOnCancelHandler(function () {\n    $('.cpc').hide();\n  });\n  x.hide();y.hide();z.hide();\n  injectColor('bg-color', kit.backgroundColor);\n  injectColor('line-color', kit.lineColor);\n  injectColor('bodybg-color', kit.bodybg);\n  $('body, html').attr('style', 'background-color:#'+kit.bodybg);\n\n  $('#bg-color').click(function() {\n    z.hide();\n    z.setColor($(this).attr('color'));\n    currentSelector = $(this).attr('id');\n    $('#cpc-bg').attr('style', 'width: 252px;');\n    z.show();\n  });\n  $('#bodybg-color').click(function() {\n    y.hide();\n    y.setColor($(this).attr('color'));\n    currentSelector = $(this).attr('id');\n    $('#cpc-bodybg').attr('style', 'width: 252px; top:' + 53 + 'px;');\n    y.show();\n  });\n  $('#line-color').click(function() {\n    x.hide();\n    x.setColor($(this).attr('color'));\n    currentSelector = $(this).attr('id');\n    $('#cpc-line').attr('style', 'width: 252px;');\n    x.show();\n  });\n}\n\nfunction setColor(color) {\n  var kit = window.kit;\n  if(currentSelector === 'bg-color') {\n    $(currentSelector).attr('style', 'background-color:' + color + ';');\n    $(currentSelector+' img').hide();\n    injectColor(currentSelector, color.substring(1));\n    $(currentSelector+'+ img').show();\n    kit.backgroundColor = color.substring(1);\n    kit.redraw();\n  } else if(currentSelector === 'line-color') {\n    $(currentSelector).attr('style', 'background-color:' + color + ';');\n    $(currentSelector+' img').hide();\n    injectColor(currentSelector, color.substring(1));\n    $(currentSelector+'+ img').show();\n    kit.lineColor = color.substring(1);\n    kit.redraw();\n  } else if( currentSelector === 'bodybg-color') {\n    $(currentSelector).attr('style', 'background-color:' + color + ';');\n    $(currentSelector+' img').hide();\n    injectColor(currentSelector, color.substring(1));\n    $(currentSelector+'+ img').show();\n    $('body, html').attr('style', 'background-color:'+color);\n  }\n  $('.cpc').hide();\n}\n\nfunction injectColor(id, color) {\n  var thisC = $('#' + id);\n  var theseC = new Array(kit._u.decodeFromHex(color.substring(0, 2)), kit._u.decodeFromHex(color.substring(2, 4)),kit._u.decodeFromHex(color.substring(4, 6)));\n  thisC.attr('style', 'background-color: #' + color);\n  thisC.attr('color', color);\n  //$('#' + id).html(gripImg(theseC[0],theseC[1] ,theseC[2]));\n  return false;\n}\n\n// KEYBOARD HANDLING\nfunction initKeyboard() {\n  document.addEventListener(\"keydown\", keyDownHandler);\n}\n\nfunction keyDownHandler(event) {\n  if(kit.fieldFocus==true) {\n    return false;\n  }\n  var keyPressed = String.fromCharCode(event.keyCode);\n\n  // OBJECT SELECTION\n  if(keyPressed === '1') {   \n    kit.selectObject(0);\n  } else if(keyPressed === '2') { \n    kit.selectObject(1);\n  } else if(keyPressed === '3') { \n    kit.selectObject(2);\n  } else if(keyPressed === '4') { \n    kit.selectObject(3);\n\n  // KEYFRAME SELECTION\n  // LEFT CURSOR (BACK)\n  } else if(event.keyCode=='37'||keyPressed=='%') { \n    kit.selectPrev();\n  // RIGHT CURSOR (FORWARD)\n  } else if(event.keyCode=='39'||keyPressed==\"'\") { \n    kit.selectNext();\n  // 65 A KEY (STOP)\n  } else if(keyPressed == 'A') { \n    kit.stopScene();\n  // 83 S KEY (START)\n  } else if (keyPressed == 'S') { \n    kit.loopInit();\n    kit.sceneLoop();\n\n  // EDIT MODES  \n  } else if(keyPressed == 'Q') { \n    $('.edit-mode button').removeClass('active');\n    $('#edit-shape').addClass('active');\n    kit.editMode = kit.constants.EDIT_SHAPE;\n    kit.redraw();\n  } else if(keyPressed == 'W') { \n    $('.edit-mode button').removeClass('active');\n    $('#edit-transform').addClass('active');\n    kit.editMode = kit.constants.EDIT_TRANSFORM;\n    kit.redraw();\n  } else if(keyPressed == 'E') { \n    $('.edit-mode button').removeClass('active');\n    $('#edit-none').addClass('active');\n    kit.editMode = kit.constants.EDIT_NONE;\n    kit.redraw();\n  }\n  kit.digest();\n  return false;\n}\n\nfunction getSampleJSON() {\n  return $.parseJSON(sampleJSON);\n}\nvar sampleJSON = '[{\"backgroundColor\":\"010201\",\"backgroundAlpha\":\"1\",\"lineColor\":\"9fb4f4\",\"sourceMode\":\"lighter\",\"seamlessAnimation\":true},{\"fillImageSource\":\"styles/img/darkmountain.jpg\"}, \\\n[[\"flower\",\"12\",1],[\"flower\",6,2]],[{\"obj\":[{\"shapePoints\":[{\"x\":-0.5590233628997393,\"y\":-2.0863035929598417},{\"x\":12.1485961292003,\"y\":-128.88002328150233},{\"x\":-49.11165462656021,\"y\":-78.63714243359995},{\"x\":0,\"y\":-132.16734734352232}], \\\n\"rotation\":5.754529970058761,\"scale\":0.834656832,\"position\":{\"x\":250,\"y\":250}},{\"shapePoints\":[{\"x\":-30.122221832793045,\"y\":-17.391072883752692},{\"x\":85.9704641350211,\"y\":-161.39240506329114},{\"x\":10.021097046413503,\"y\":-69.62025316455697},{\"x\":0,\"y\":-227.27272727272725}], \\\n\"rotation\":0,\"scale\":0.948,\"position\":{\"x\":250,\"y\":250}}],\"timing\":1.0},{\"obj\":[{\"shapePoints\":[{\"x\":-66.54834810398798,\"y\":-248.36181628386313},{\"x\":49.62409043622804,\"y\":-209.6660121056433},{\"x\":-2.8280655533554153,\"y\":-179.2534302318673},{\"x\":0,\"y\":-216.07629402658225}], \\\n\"rotation\":5.754529970058761,\"scale\":0.834656832,\"position\":{\"x\":250,\"y\":250}},{\"shapePoints\":[{\"x\":-50.807731559059285,\"y\":-29.33385749253713},{\"x\":85.9704641350211,\"y\":-161.39240506329114},{\"x\":-104.957805907173,\"y\":-23.206751054852322},{\"x\":0,\"y\":-184.59915611814347}], \\\n\"rotation\":0,\"scale\":0.948,\"position\":{\"x\":250,\"y\":250}}],\"timing\":1.5},{\"obj\":[{\"shapePoints\":[{\"x\":-65.67787952632173,\"y\":-245.11318332562047},{\"x\":71.17540024282371,\"y\":-194.3026064157911},{\"x\":-49.58058173540719,\"y\":283.2295565935227},{\"x\":0,\"y\":-221.42302992745593}], \\\n\"rotation\":5.754529970058761,\"scale\":0.834656832,\"position\":{\"x\":250,\"y\":250}},{\"shapePoints\":[{\"x\":-50.807731559059285,\"y\":-29.33385749253713},{\"x\":179.8523206751055,\"y\":-123.41772151898735},{\"x\":-87.02531645569621,\"y\":-53.797468354430386},{\"x\":0,\"y\":-184.59915611814347}], \\\n\"rotation\":0,\"scale\":0.948,\"position\":{\"x\":250,\"y\":250}}],\"timing\":1.5},{\"obj\":[{\"shapePoints\":[{\"x\":-65.96639670082932,\"y\":-246.189944079739},{\"x\":71.17540024282371,\"y\":-194.3026064157911},{\"x\":-49.58058173540719,\"y\":283.2295565935227},{\"x\":0,\"y\":-221.42302992745593}], \\\n\"rotation\":6.278799370390794,\"scale\":0.831318204672,\"position\":{\"x\":250,\"y\":250}},{\"shapePoints\":[{\"x\":-50.807731559059285,\"y\":-29.33385749253713},{\"x\":186.54792286874587,\"y\":-75.04468951175927},{\"x\":-111.0347001039193,\"y\":-52.22737611648803},{\"x\":0,\"y\":-209.9105782470954}], \\\n\"rotation\":6.2783309763779105,\"scale\":0.948,\"position\":{\"x\":250,\"y\":250}}],\"timing\":1.5},{\"obj\":[{\"shapePoints\":[{\"x\":-65.96639670082932,\"y\":-246.189944079739},{\"x\":71.17540024282371,\"y\":-194.3026064157911},{\"x\":-49.58058173540719,\"y\":283.2295565935227},{\"x\":0,\"y\":-221.42302992745593}], \\\n\"rotation\":1.5707963267948966,\"scale\":0.831318204672,\"position\":{\"x\":250,\"y\":250}}, {\"shapePoints\":[{\"x\":-180.25999522596678,\"y\":-104.07315676783261},{\"x\":232.95851490149536,\"y\":-96.50532974597995},{\"x\":158.37056109488017,\"y\":-245.92687765652},{\"x\":0,\"y\":-151.39389500364405}], \\\n\"rotation\":1.5616641605754857,\"scale\":0.948,\"position\":{\"x\":250,\"y\":250}}],\"timing\":1.5},{\"obj\":[{\"shapePoints\":[{\"x\":-65.96639670082932,\"y\":-246.189944079739},{\"x\":71.17540024282371,\"y\":-194.3026064157911},{\"x\":-49.58058173540719,\"y\":283.2295565935227},{\"x\":0,\"y\":-221.42302992745593}], \\\n\"rotation\":3.1765783724183185,\"scale\":0.6015418529006592,\"position\":{\"x\":250,\"y\":250}},{\"shapePoints\":[{\"x\":-50.807731559059285,\"y\":-29.33385749253713},{\"x\":179.8523206751055,\"y\":-123.41772151898735},{\"x\":-87.02531645569621,\"y\":-53.797468354430386},{\"x\":0,\"y\":-184.59915611814347}], \\\n\"rotation\":3.1717559163149986,\"scale\":0.77736,\"position\":{\"x\":250,\"y\":250}}],\"timing\":1.5},{\"obj\":[{\"shapePoints\":[{\"x\":-62.29535079792313,\"y\":-232.48941425317554},{\"x\":71.17540024282371,\"y\":-194.3026064157911},{\"x\":-49.58058173540719,\"y\":283.2295565935227},{\"x\":0,\"y\":-183.37388641602942}], \\\n\"rotation\":4.702339067491655,\"scale\":0.34850189248977714,\"position\":{\"x\":250,\"y\":250}},{\"shapePoints\":[{\"x\":-50.807731559059285,\"y\":-29.33385749253713},{\"x\":179.8523206751055,\"y\":-123.41772151898735},{\"x\":-87.02531645569621,\"y\":-53.797468354430386},{\"x\":0,\"y\":-184.59915611814347}], \\\n\"rotation\":1.5939135951791896,\"scale\":0.337654848,\"position\":{\"x\":250,\"y\":250}}],\"timing\":1.5}]]';\n"]}